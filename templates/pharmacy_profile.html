{% extends "base.html" %}

{% block title %}Profil Apotek - Manajemen Apotek{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h2><i class="fas fa-building"></i> Profil Apotek</h2>
        <hr>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5><i class="fas fa-info-circle"></i> Informasi Apotek</h5>
                {% if current_user.is_admin() %}
                <a href="{{ url_for('edit_pharmacy_profile') }}" class="btn btn-primary btn-sm">
                    <i class="fas fa-edit"></i> Edit Profil
                </a>
                {% endif %}
            </div>
            <div class="card-body">
                {% if profile %}
                {% if profile and profile.logo_url %}
                        <div class="text-center mb-3">
                            <img src="{{ profile.logo_url }}" alt="Logo {{ profile.name }}" 
                                 class="img-thumbnail" style="max-width: 200px; max-height: 200px;"
                                 onerror="this.style.display='none';">
                        </div>
                        {% endif %}
                <dl class="row">
                    <dt class="col-sm-3">Nama Apotek:</dt>
                    <dd class="col-sm-9">{{ profile.name }}</dd>

                    <dt class="col-sm-3">Alamat:</dt>
                    <dd class="col-sm-9">{{ profile.address }}</dd>

                    <dt class="col-sm-3">Telepon:</dt>
                    <dd class="col-sm-9">{{ profile.phone }}</dd>

                    <dt class="col-sm-3">Email:</dt>
                    <dd class="col-sm-9">{{ profile.email }}</dd>

                    <dt class="col-sm-3">Nomor Izin:</dt>
                    <dd class="col-sm-9">{{ profile.license_number }}</dd>

                    <dt class="col-sm-3">Apoteker:</dt>
                    <dd class="col-sm-9">{{ profile.pharmacist_name }}</dd>

                    <dt class="col-sm-3">Dibuat:</dt>
                    <dd class="col-sm-9">{{ profile.created_at.strftime('%d/%m/%Y %H:%M') }}</dd>

                    {% if profile.updated_at != profile.created_at %}
                    <dt class="col-sm-3">Diperbarui:</dt>
                    <dd class="col-sm-9">{{ profile.updated_at.strftime('%d/%m/%Y %H:%M') }}</dd>
                    {% endif %}
                </dl>
                {% else %}
                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>Perhatian:</strong>
                    Hanya administrator yang dapat mengubah profil apotek.
                </div>

                <div class="alert alert-info">
                    <i class="fas fa-code"></i>
                    <strong>Developer:</strong>
                    Sistem ini dikembangkan oleh <strong>Fajar Julyana</strong>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-chart-bar"></i> Statistik Apotek</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <div class="d-flex justify-content-between">
                        <span>Total Obat:</span>
                        <strong>0</strong>
                    </div>
                </div>

                <div class="mb-3">
                    <div class="d-flex justify-content-between">
                        <span>Transaksi Hari Ini:</span>
                        <strong>0</strong>
                    </div>
                </div>

                <div class="mb-3">
                    <div class="d-flex justify-content-between">
                        <span>Transaksi Bulan Ini:</span>
                        <strong>0</strong>
                    </div>
                </div>

                <div class="mb-3">
                    <div class="d-flex justify-content-between">
                        <span>Obat Hampir Habis:</span>
                        <strong class="text-warning">0</strong>
                    </div>
                </div>

                <div class="mb-3">
                    <div class="d-flex justify-content-between">
                        <span>Obat Kadaluwarsa:</span>
                        <strong class="text-danger">0</strong>
                    </div>
                </div>

                <hr>

                <div class="text-center">
                    <button type="button" class="btn btn-outline-primary btn-sm" onclick="refreshStats()">
                        <i class="fas fa-sync-alt"></i> Refresh Statistik
                    </button>
                </div>
            </div>
        </div>

        <div class="card mt-3">
            <div class="card-header">
                <h5><i class="fas fa-users"></i> Pengguna Sistem</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <div class="d-flex justify-content-between">
                        <span>Total Admin:</span>
                        <strong>1</strong>
                    </div>
                </div>

                <div class="mb-3">
                    <div class="d-flex justify-content-between">
                        <span>Total Kasir:</span>
                        <strong>0</strong>
                    </div>
                </div>

                {% if current_user.is_admin() %}
                <div class="text-center">
                    <button type="button" class="btn btn-outline-success btn-sm" onclick="addUser()">
                        <i class="fas fa-user-plus"></i> Tambah Pengguna
                    </button>
                </div>
                {% endif %}
            </div>
        </div>

        <div class="card mt-3">
            <div class="card-header">
                <h5><i class="fas fa-cog"></i> Pengaturan Sistem</h5>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <button type="button" class="btn btn-outline-info btn-sm" onclick="backupData()">
                        <i class="fas fa-download"></i> Backup Data
                    </button>

                    {% if current_user.is_admin() %}
                    <button type="button" class="btn btn-outline-warning btn-sm" onclick="systemSettings()">
                        <i class="fas fa-tools"></i> Pengaturan Sistem
                    </button>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function refreshStats() {
    // TODO: Implement real-time statistics refresh
    alert('Statistik akan di-refresh secara real-time');
}

function addUser() {
    // TODO: Implement user management
    alert('Fitur manajemen pengguna akan segera diimplementasi');
}

function backupData() {
    if (confirm('Apakah Anda ingin melakukan backup data sekarang?')) {
        // TODO: Implement data backup
        alert('Fitur backup data akan segera diimplementasi');
    }
}

function systemSettings() {
    // TODO: Implement system settings
    alert('Fitur pengaturan sistem akan segera diimplementasi');
}

// Placeholder for upload logo functionality
function uploadLogo() {
    // This function would handle the upload of the pharmacy logo.
    // It would typically involve a file input and an AJAX request to the server.
    alert('Fitur upload logo apotek akan segera diimplementasi');
}
</script>
{% endblock %}